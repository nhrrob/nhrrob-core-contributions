(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,n=window.wp.blockEditor,r=window.wp.components,o=window.wp.element,s=window.wp.apiFetch;var i=e.n(s);const a=JSON.parse('{"UU":"nhrcc-core-contributions/core-contributions-block"}'),c=window.ReactJSXRuntime;(0,t.registerBlockType)(a.UU,{edit:function({attributes:e,setAttributes:t}){const s=(0,n.useBlockProps)(),[a,d]=(0,o.useState)(e.username),[p,m]=(0,o.useState)(""),[h,w]=(0,o.useState)(!1),b=(0,o.useRef)(function(){let e;return(...n)=>{clearTimeout(e),e=setTimeout((()=>(e=>{t({username:e})})(...n)),500)}}()).current;return(0,o.useEffect)((()=>{e.username||t({username:nhrccCoreContributionsCommonObj?.nhrccSettings?.username||"",preset:nhrccCoreContributionsCommonObj?.nhrccSettings?.preset||"default"})}),[]),(0,o.useEffect)((()=>{e.username?(w(!0),async function(e){try{return(await i()({path:"/nhrcc-core-contributions/v1/core-contributions/render",method:"POST",data:e})).content||""}catch(e){throw console.error("Failed to fetch preview:",e),new Error("Failed to load preview")}}(e).then(m).catch((e=>{console.error("Failed to load preview:",e),m(`Error: ${e.message}`)})).finally((()=>w(!1)))):m("")}),[e.username,e.preset]),(0,c.jsxs)("div",{...s,children:[(0,c.jsx)(n.InspectorControls,{children:(0,c.jsxs)(r.PanelBody,{title:"Core Contributions Settings",children:[(0,c.jsx)(r.TextControl,{label:"WordPress.org Username",value:a,onChange:e=>{d(e),b(e)},help:"Enter your WordPress.org username to display contributions"}),(0,c.jsx)(r.SelectControl,{label:"Design Style",value:e.preset,options:l,onChange:e=>t({preset:e})})]})}),(0,c.jsx)(u,{isLoading:h,username:e.username,content:p})]})},save:()=>null});const l=[{label:"Default",value:"default"},{label:"Minimal",value:"minimal"}];function u({isLoading:e,username:t,content:n}){return e?(0,c.jsx)(r.Spinner,{}):t?(0,c.jsx)("div",{className:"nhr-core-contributions-preview",dangerouslySetInnerHTML:{__html:n}}):(0,c.jsx)("div",{className:"components-placeholder",children:(0,c.jsx)("p",{children:"Please set a WordPress.org username to preview the contributions."})})}})();